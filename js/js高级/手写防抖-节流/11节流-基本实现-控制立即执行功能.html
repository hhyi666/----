<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <!-- button也可以加上事防抖操作 -->
    <button>按钮</button>
    <input type="text">
    <!-- 使用CDN进行引用 -->
     <!--或者直接下载到本地，再引用 -->
     
    <!-- <script src="js/underscore-umd-min.js"></script> -->
    <script>
        const inputEl = document.querySelector("input")

        // let index = 1
        // inputEl.oninput = _.debounce(function () { //减缓函数的执行频率
        //     console.log(`发送网络请求${index++}:,`, this.value)
        // }, 1000) 


        //4，节流处理的代码 按照固定的频率进行执行
        //自己实现节流函数 fn执行的函数    第一次不执行也可以进行控制  最后一次不不执行也可以进行控制
        function hythrottle(fn,interval,leading = true,trailing = true){
            let startTime = 0
            const _throttle = function(...args){ //可以传入参数

                const nowTime = new Date().getTime() //现在时间会非常大

                //1.对第一次立即执行进行控制,只有第一次 不需要立即执行
                if(!leading && startTime === 0){
                    startTime = nowTime
                }
                const waitTime = interval - (nowTime - startTime) //第一次立即执行 这个是直接就是负值

                if(waitTime <= 0){
                    fn.apply(this,args) //使用apply进行绑定
                    startTime = nowTime
                }
                //这里直接执行相当于函数的直接调用  this绑定的window
            }
            return _throttle
        }


        let counter = 1
        inputEl.oninput = hythrottle(function(event){
            console.log(`发送网络请求：${counter++}`,this.value,event)
        },3000,false) //每三秒进行触发
    </script>
</body>

</html>